import{j as e}from"./chunk-aAkv6woa.js";import{r as s}from"./chunk-CRvknJha.js";import{o as a,s as r,f as t,i as l,t as c,J as i,C as n,c as d,a as o,b as m,d as x,B as u,j as h,k as j,l as p,m as f,n as g,I as v,p as N,L as w}from"../assets/index-i8wSawhV.js";import{S as b,a as y,b as A,c as C,d as R}from"./chunk-B6dbaAgB.js";import{c as S,B as k}from"./chunk-C2Wav99Y.js";import{T as P,a as D,b as E,c as J}from"./chunk-CKUYYoyY.js";import{D as L,d as F,a as z,b as I,c as T,e as V}from"./chunk-IPbBWae1.js";import{A as $}from"./chunk-SshbQ2oS.js";import{y as M,aq as O,I as B,U,n as _,g as q,P as G,a4 as H,a1 as K,ax as Q,E as W,ay as X,az as Y}from"./chunk-CFjh8-P5.js";import"./chunk-oqmhCI76.js";import"./chunk-DdJ5UvfL.js";import"./chunk-Djsr9rkS.js";import"./chunk-BS4ofh5H.js";const Z=a({name:r().min(1,"Please enter the name"),email:r().email("Please enter a valid email"),password:r().min(6,"Password must be at least 6 characters")}),ee=()=>{const[a,r]=s.useState(null),[ee,se]=s.useState({totalJobs:0,activeJobs:0,totalApplicants:0,pendingApplications:0,recentApplications:[]}),[ae,re]=s.useState([]),[te,le]=s.useState([]),[ce,ie]=s.useState(!1),[ne,de]=s.useState(!0),[oe,me]=s.useState(!1),[xe,ue]=s.useState(!1),[he,je]=s.useState({}),[pe,fe]=s.useState({}),[ge,ve]=s.useState(""),[Ne,we]=s.useState("all"),[be,ye]=s.useState({}),[Ae,Ce]=s.useState(null),Re=t({resolver:l(Z),defaultValues:{name:"",email:"",password:""}});s.useEffect(()=>{const e=localStorage.getItem("admin_user");r(e?JSON.parse(e):null),Pe(),Se(),ke()},[]),s.useEffect(()=>{a&&"Admin"!==a.role&&(window.location.href="/admin")},[a]);const Se=async()=>{try{const e=await S.getDashboardStats();se(e)}catch(e){}finally{de(!1)}},ke=async()=>{try{const e=await S.getJobPostings(!0);re(e.slice(0,5))}catch(e){}},Pe=async()=>{try{const e=await c.listRecruiters();le(e||[])}catch(e){i.error("Failed to load recruiters")}},De=te.filter(e=>{const s=e.name?.toLowerCase().includes(ge.toLowerCase())||e.email?.toLowerCase().includes(ge.toLowerCase()),a="all"===Ne||e.role===Ne;return s&&a});return e.jsx($,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Admin Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage recruiter accounts and oversee the career system"})]}),e.jsxs(k,{variant:"secondary",className:"text-sm",children:[e.jsx(M,{className:"w-4 h-4 mr-1"}),"Administrator"]})]}),e.jsxs(P,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(D,{className:"grid w-full grid-cols-2",children:[e.jsx(E,{value:"overview",children:"Dashboard Overview"}),e.jsx(E,{value:"recruiters",children:"Recruiter Management"})]}),e.jsxs(J,{value:"overview",className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:ne?Array.from({length:4}).map((s,a)=>e.jsx(n,{className:"hover:shadow-md transition-shadow",children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-8 bg-muted rounded w-1/3"})]})})},a)):[{title:"Total Jobs",value:ee.totalJobs,icon:O,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Active Jobs",value:ee.activeJobs,icon:B,color:"text-green-600",bgColor:"bg-green-100"},{title:"Total Applicants",value:ee.totalApplicants,icon:U,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Pending Applications",value:ee.pendingApplications,icon:_,color:"text-orange-600",bgColor:"bg-orange-100"}].map(s=>{const a=s.icon;return e.jsx(n,{className:"hover:shadow-md transition-shadow",children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s.title}),e.jsx("p",{className:"text-2xl font-bold text-foreground",children:s.value})]}),e.jsx("div",{className:`w-12 h-12 ${s.bgColor} rounded-lg flex items-center justify-center`,children:e.jsx(a,{className:`w-6 h-6 ${s.color}`})})]})})},s.title)})}),e.jsxs(n,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"Recent Applications"}),e.jsx(x,{children:"Latest job applications in the system"})]}),e.jsx(d,{children:ne?e.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((s,a)=>e.jsx("div",{className:"p-4 border border-border rounded-lg",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-1/3 mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/2 mb-1"}),e.jsx("div",{className:"h-3 bg-muted rounded w-2/3"})]})},a))}):0===ee.recentApplications.length?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No recent applications"}):e.jsx("div",{className:"space-y-4",children:ee.recentApplications.map(s=>e.jsx("div",{className:"flex items-center justify-between p-4 border border-border rounded-lg hover:bg-accent/50 transition-colors",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("h3",{className:"font-medium text-foreground",children:s.name}),e.jsx(k,{variant:"outline",children:s.status})]}),e.jsxs("p",{className:"text-sm text-foreground mb-2",children:["Application ID:"," ",e.jsx("span",{className:"font-medium",children:s.id.slice(0,8)})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-3 h-3"}),s.email]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"w-3 h-3"}),s.phone]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(H,{className:"w-3 h-3"}),new Date(s.appliedAt).toLocaleDateString()]})]})]})},s.id))})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(n,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"Recent Job Postings"}),e.jsx(x,{children:"Latest jobs created in the system"})]}),e.jsx(d,{children:0===ae.length?e.jsx("div",{className:"text-center py-6 text-muted-foreground",children:"No jobs found"}):e.jsx("div",{className:"space-y-3",children:ae.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:s.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.department," • ",s.location]})]}),e.jsx(k,{variant:"Active"===s.status?"default":"secondary",children:s.status})]},s.id))})})]}),e.jsxs(n,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"Recent Recruiters"}),e.jsx(x,{children:"Most recently created recruiter accounts"})]}),e.jsx(d,{children:0===te.length?e.jsx("div",{className:"text-center py-6 text-muted-foreground",children:"No recruiters found"}):e.jsx("div",{className:"space-y-3",children:te.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:s.name||"No Name"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email})]}),e.jsx(k,{variant:"Admin"===s.role?"default":"secondary",children:s.role})]},s.id))})})]})]})]}),e.jsxs(J,{value:"recruiters",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Recruiter Accounts"}),e.jsxs(L,{open:oe,onOpenChange:me,children:[e.jsx(F,{asChild:!0,children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"Create Recruiter"]})}),e.jsxs(z,{children:[e.jsxs(I,{children:[e.jsx(T,{children:"Create New Recruiter Account"}),e.jsx(V,{children:"Create a new recruiter account with limited permissions"})]}),e.jsx(h,{...Re,children:e.jsxs("form",{onSubmit:Re.handleSubmit(async e=>{ie(!0);try{const s=await c.signUp(e.email,e.password,"Recruiter",e.name);s?(fe(a=>({...a,[s.id]:e.password})),i.success("Recruiter account created successfully!"),me(!1),Re.reset(),Pe()):i.error("Failed to create recruiter account")}catch(s){i.error("Failed to create recruiter account")}finally{ie(!1)}}),className:"space-y-4",children:[e.jsx(j,{control:Re.control,name:"name",render:({field:s})=>e.jsxs(p,{children:[e.jsx(f,{children:"Full Name"}),e.jsx(g,{children:e.jsx(v,{placeholder:"Enter full name",...s})}),e.jsx(N,{})]})}),e.jsx(j,{control:Re.control,name:"email",render:({field:s})=>e.jsxs(p,{children:[e.jsx(f,{children:"Email"}),e.jsx(g,{children:e.jsx(v,{placeholder:"Enter email address",...s})}),e.jsx(N,{})]})}),e.jsx(j,{control:Re.control,name:"password",render:({field:s})=>e.jsxs(p,{children:[e.jsx(f,{children:"Password"}),e.jsx(g,{children:e.jsxs("div",{className:"relative",children:[e.jsx(v,{type:xe?"text":"password",placeholder:"Enter password",...s}),e.jsx(u,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>ue(!xe),children:xe?e.jsx(Q,{className:"h-4 w-4"}):e.jsx(W,{className:"h-4 w-4"})})]})}),e.jsx(N,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>me(!1),children:"Cancel"}),e.jsx(u,{type:"submit",disabled:ce,children:ce?"Creating...":"Create Account"})]})]})})]})]})]}),e.jsx(n,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(v,{placeholder:"Search recruiters by name or email...",value:ge,onChange:e=>ve(e.target.value)})}),e.jsxs(b,{value:Ne,onValueChange:e=>we(e),children:[e.jsx(y,{className:"w-full lg:w-52",children:e.jsx(A,{placeholder:"Filter by role"})}),e.jsxs(C,{children:[e.jsx(R,{value:"all",children:"All Roles"}),e.jsx(R,{value:"Admin",children:"Admin"}),e.jsx(R,{value:"Recruiter",children:"Recruiter"})]})]})]})})}),e.jsx("div",{className:"grid gap-4",children:De.map(s=>e.jsxs(n,{children:[e.jsxs(d,{className:"flex items-center justify-between p-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(U,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name||"No Name"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(k,{variant:"Admin"===s.role?"default":"secondary",children:s.role}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Created ",new Date(s.created_at).toLocaleDateString()]})]}),a?.id!==s.id&&e.jsxs("div",{className:"mt-3 flex flex-col gap-2",children:[e.jsx(w,{className:"text-xs text-muted-foreground",children:"Role"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{value:be[s.id]||s.role,onValueChange:e=>{return a=s.id,r=e,void ye(e=>({...e,[a]:r}));var a,r},children:[e.jsx(y,{className:"w-40",children:e.jsx(A,{})}),e.jsxs(C,{children:[e.jsx(R,{value:"Admin",children:"Admin"}),e.jsx(R,{value:"Recruiter",children:"Recruiter"})]})]}),e.jsx(u,{size:"sm",variant:"outline",disabled:!be[s.id]||Ae===s.id,onClick:()=>(async e=>{const s=be[e];if(s){Ce(e);try{if(!(await c.updateRecruiterRole(e,s)))throw new Error("Role update failed");i.success("Role updated successfully"),Pe()}catch(a){i.error("Failed to update role")}finally{Ce(null)}}})(s.id),children:Ae===s.id?"Saving...":"Save Role"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>(async(e,s)=>{const a=prompt(`Enter new password for ${s}:`);if(!a||a.length<6)i.error("Password must be at least 6 characters");else try{if(!(await c.resetRecruiterPassword(e,a)))throw new Error("Reset failed");fe(s=>({...s,[e]:a})),i.success("Password reset successfully!"),Pe()}catch(r){i.error("Failed to reset password")}})(s.id,s.email),className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-4 h-4"}),"Reset Password"]}),"Admin"!==s.role&&e.jsxs(u,{variant:"destructive",size:"sm",onClick:()=>(async(e,s)=>{if(confirm(`Are you sure you want to delete the recruiter account for ${s}?`))try{if(!(await c.deleteRecruiter(e)))throw new Error("Delete failed");i.success("Recruiter account deleted successfully"),Pe()}catch(a){i.error("Failed to delete recruiter account")}})(s.id,s.email),className:"flex items-center gap-1",children:[e.jsx(Y,{className:"w-4 h-4"}),"Delete"]})]})]}),he[s.id]&&e.jsx(d,{className:"pt-0",children:e.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Current Password:"}),e.jsx("p",{className:"text-sm font-mono bg-background px-2 py-1 rounded border",children:pe[s.id]||"Password is encrypted - use Reset Password to set a new one"}),pe[s.id]&&e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"✓ This password was recently set and is temporarily visible"})]})})]},s.id))})]})]})]})})};export{ee as default};
