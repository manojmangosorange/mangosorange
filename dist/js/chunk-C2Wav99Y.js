import{j as e}from"./chunk-aAkv6woa.js";import{a as t}from"./chunk-DdJ5UvfL.js";import{v as i,z as a}from"../assets/index-i8wSawhV.js";const r=t("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n({className:t,variant:a,...n}){return e.jsx("div",{className:i(r({variant:a}),t),...n})}const s=e=>Array.isArray(e)?e:e?.data&&Array.isArray(e.data)?e.data:e?.items&&Array.isArray(e.items)?e.items:[],o=e=>e?Array.isArray(e)?e[0]||null:e?.data&&!Array.isArray(e.data)?e.data:e:null,p={async getJobPostings(e=!1){try{const t=e?"jobs.php?includeHidden=1":"jobs.php",i=await a.get(t);return s(i).map(e=>({id:String(e.id),title:e.title,department:e.department,type:e.type,location:e.location,experience:e.experience,salary:e.salary,description:e.description,responsibilities:e.responsibilities,requirements:e.requirements,deadline:e.deadline,status:e.status,isVisible:Boolean(e.is_visible),createdAt:e.created_at,updatedAt:e.updated_at,applicantCount:Number(e.applicant_count||0)}))}catch(t){return[]}},async getJobPosting(e){try{const t=await a.get(`jobs.php?id=${encodeURIComponent(e)}`),i=o(t);return i?{id:String(i.id),title:i.title,department:i.department,type:i.type,location:i.location,experience:i.experience,salary:i.salary,description:i.description,responsibilities:i.responsibilities,requirements:i.requirements,deadline:i.deadline,status:i.status,isVisible:Boolean(i.is_visible),createdAt:i.created_at,updatedAt:i.updated_at}:null}catch(t){return null}},async createJobPosting(e){try{const t=await a.post("jobs.php",{title:e.title,department:e.department,type:e.type,location:e.location,experience:e.experience,salary:e.salary,description:e.description,responsibilities:e.responsibilities,requirements:e.requirements,deadline:e.deadline,status:e.status,is_visible:e.isVisible}),i=o(t)||{};return{id:i.id?String(i.id):"new",title:i.title??e.title,department:i.department??e.department,type:i.type??e.type,location:i.location??e.location,experience:i.experience??e.experience,salary:i.salary??e.salary,description:i.description??e.description,responsibilities:i.responsibilities??e.responsibilities,requirements:i.requirements??e.requirements,deadline:i.deadline??e.deadline,status:i.status??e.status,isVisible:Boolean(i.is_visible??e.isVisible),createdAt:i.created_at??(new Date).toISOString(),updatedAt:i.updated_at??(new Date).toISOString()}}catch(t){return null}},async updateJobPosting(e,t){try{const i={};return void 0!==t.title&&(i.title=t.title),void 0!==t.department&&(i.department=t.department),void 0!==t.type&&(i.type=t.type),void 0!==t.location&&(i.location=t.location),void 0!==t.experience&&(i.experience=t.experience),void 0!==t.salary&&(i.salary=t.salary),void 0!==t.description&&(i.description=t.description),void 0!==t.responsibilities&&(i.responsibilities=t.responsibilities),void 0!==t.requirements&&(i.requirements=t.requirements),void 0!==t.deadline&&(i.deadline=t.deadline),void 0!==t.status&&(i.status=t.status),void 0!==t.isVisible&&(i.is_visible=t.isVisible),await a.put(`jobs.php?id=${encodeURIComponent(e)}`,{id:e,...i}),!0}catch(i){return!1}},async deleteJobPosting(e){try{return await a.delete(`jobs.php?id=${encodeURIComponent(e)}`),!0}catch(t){return!1}},async getApplicants(e){try{const t=e?`applicants.php?job_id=${encodeURIComponent(e)}`:"applicants.php",i=await a.get(t);return s(i).map(e=>({id:String(e.id),jobId:e.job_id?String(e.job_id):"",name:e.name||"",email:e.email||"",phone:e.phone||"",resumeUrl:e.resume_url||"",coverLetter:e.cover_letter||"",status:e.status||"Applied",notes:e.notes||"",appliedAt:e.applied_at,updatedAt:e.updated_at,jobTitle:e.job_title||""}))}catch(t){return[]}},async updateApplicantStatus(e,t,i){try{return await a.put("applicants.php",{id:e,status:t,notes:i}),!0}catch(r){return!1}},async submitApplication(e){try{return await a.post("applicants.php",{jobId:e.jobId||null,name:e.name,email:e.email,phone:e.phone||null,resumeUrl:e.resumeUrl,coverLetter:e.coverLetter||null}),!0}catch(t){return!1}},async getGeneralApplications(){try{const e=await a.get("applicants.php?general=1");return s(e).map(e=>({id:String(e.id),jobId:"",name:e.name||"",email:e.email||"",phone:e.phone||"",resumeUrl:e.resume_url||"",coverLetter:e.cover_letter||"",status:e.status||"Applied",notes:e.notes||"",appliedAt:e.applied_at,updatedAt:e.updated_at}))}catch(e){return[]}},async getDashboardStats(){try{const[e,t]=await Promise.all([a.get("jobs.php?includeHidden=1"),a.get("applicants.php")]),i=s(e),r=s(t),n=i.length,o=i.filter(e=>"Active"===e.status).length,p=r.length,l=r.filter(e=>"Applied"===(e.status||"Applied")).length;return{totalJobs:n,activeJobs:o,totalApplicants:p,pendingApplications:l,recentApplications:r.slice().sort((e,t)=>{const i=new Date(e.applied_at||0).getTime();return new Date(t.applied_at||0).getTime()-i}).slice(0,5).map(e=>({id:String(e.id),jobId:e.job_id?String(e.job_id):"",name:e.name||"",email:e.email||"",phone:e.phone||"",resumeUrl:e.resume_url||"",coverLetter:e.cover_letter||"",status:e.status||"Applied",notes:e.notes||"",appliedAt:e.applied_at,updatedAt:e.updated_at,jobTitle:e.job_title||""}))}}catch(e){return{totalJobs:0,activeJobs:0,totalApplicants:0,pendingApplications:0,recentApplications:[]}}},async uploadResume(e){try{const t=new FormData;t.append("file",e);return(await a.post("upload_resume.php",t)).url||null}catch(t){return null}}};export{n as B,p as c};
