import{j as e}from"./chunk-aAkv6woa.js";import{r as s}from"./chunk-CRvknJha.js";import{J as t,C as l,a,b as i,c as n,I as r,y as c,B as d}from"../assets/index-i8wSawhV.js";import{S as o,a as h,b as p,c as x,d as m}from"./chunk-B6dbaAgB.js";import{A as j}from"./chunk-SshbQ2oS.js";import{A as u}from"./chunk-Ez5QYH8a.js";import{c as f}from"./chunk-C2Wav99Y.js";import{m as g,U as v,a0 as N,ah as w}from"./chunk-CFjh8-P5.js";import"./chunk-oqmhCI76.js";import"./chunk-DdJ5UvfL.js";import"./chunk-Djsr9rkS.js";import"./chunk-BS4ofh5H.js";const y=()=>{const[y,b]=s.useState([]),[S,A]=s.useState(!0),[C,k]=s.useState(""),[R,L]=s.useState("all"),[U,D]=s.useState([]),[I,F]=s.useState("Applied"),[H,T]=s.useState(!1);s.useEffect(()=>{$()},[]);const $=async()=>{try{const e=await f.getGeneralApplications();b(e)}catch(e){t.error("Failed to load general applications")}finally{A(!1)}},E=y.filter(e=>{const s=e.name?.toLowerCase().includes(C.toLowerCase())||e.email?.toLowerCase().includes(C.toLowerCase()),t="all"===R||e.status===R;return s&&t}),G=e=>{D(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])};return S?e.jsx(j,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsx(j,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Resume Drop Applications"}),e.jsx("p",{className:"text-gray-800",children:'Manage general applications submitted through the "Apply Now" feature'})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(l,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Total Applications"}),e.jsx(v,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:y.length})})]}),e.jsxs(l,{children:[e.jsx(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"Applied"})}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:y.filter(e=>"Applied"===e.status).length})})]}),e.jsxs(l,{children:[e.jsx(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"Shortlisted"})}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:y.filter(e=>"Shortlisted"===e.status).length})})]}),e.jsxs(l,{children:[e.jsx(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"Under Review"})}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:y.filter(e=>["Interviewed","Hired"].includes(e.status)).length})})]})]}),e.jsx(l,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-800"}),e.jsx(r,{placeholder:"Search applications...",value:C,onChange:e=>k(e.target.value),className:"pl-10"})]}),e.jsxs(o,{value:R,onValueChange:L,children:[e.jsx(h,{className:"w-full lg:w-48",children:e.jsx(p,{placeholder:"Filter by status"})}),e.jsxs(x,{children:[e.jsx(m,{value:"all",children:"All Status"}),e.jsx(m,{value:"Applied",children:"Applied"}),e.jsx(m,{value:"Shortlisted",children:"Shortlisted"}),e.jsx(m,{value:"Interviewed",children:"Interviewed"}),e.jsx(m,{value:"Hired",children:"Hired"}),e.jsx(m,{value:"Rejected",children:"Rejected"})]})]})]})})}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{checked:U.length>0&&U.length===E.length,onCheckedChange:()=>{U.length===E.length?D([]):D(E.map(e=>e.id))}}),e.jsxs("span",{className:"text-sm text-gray-800",children:["Select all (",U.length,"/",E.length,")"]}),U.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(o,{value:I,onValueChange:e=>F(e),children:[e.jsx(h,{className:"w-40",children:e.jsx(p,{})}),e.jsxs(x,{children:[e.jsx(m,{value:"Applied",children:"Applied"}),e.jsx(m,{value:"Shortlisted",children:"Shortlisted"}),e.jsx(m,{value:"Interviewed",children:"Interviewed"}),e.jsx(m,{value:"Hired",children:"Hired"}),e.jsx(m,{value:"Rejected",children:"Rejected"})]})]}),e.jsx(d,{onClick:async()=>{if(0!==U.length){T(!0);try{await Promise.all(U.map(e=>f.updateApplicantStatus(e,I))),t.success(`Updated ${U.length} applications`),D([]),$()}catch(e){t.error("Failed to update applications")}finally{T(!1)}}},disabled:H,children:H?"Updating...":"Apply Status"})]})]}),e.jsxs(d,{onClick:()=>{if(0===E.length)return void t.error("No applications to export");const e=[["Name","Email","Phone","Status","Application Date","Resume URL","Cover Letter","Notes"],...E.map(e=>[e.name||"",e.email||"",e.phone||"",e.status||"",new Date(e.appliedAt).toLocaleDateString()||"",e.resumeUrl||"",e.coverLetter||"",e.notes||""])].map(e=>e.map(e=>`"${e.replace(/"/g,'""')}"`).join(",")).join("\n"),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a");if(void 0!==l.download){const e=URL.createObjectURL(s);l.setAttribute("href",e),l.setAttribute("download",(()=>{const e=(new Date).toISOString().split("T")[0];let s="All";return"all"!==R?s=R:C&&(s="Filtered"),`Resume_Drop_Applications_${s}_${e}.csv`})()),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),t.success(`Exported ${E.length} applications to CSV`)}},variant:"outline",className:"gap-2",disabled:0===E.length,children:[e.jsx(w,{className:"w-4 h-4"}),"Download CSV (",E.length,")"]})]}),0===E.length?e.jsx(l,{children:e.jsxs(n,{className:"p-12 text-center",children:[e.jsx(g,{className:"w-12 h-12 text-gray-800 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No general applications found"}),e.jsx("p",{className:"text-gray-800",children:C||"all"!==R?"Try adjusting your search or filters":'General applications from the "Apply Now" feature will appear here'})]})}):e.jsx("div",{className:"grid gap-6",children:E.map(s=>e.jsx(u,{applicant:s,onUpdate:$,jobTitle:"General Application",isGeneralApplication:!0,selectable:!0,selected:U.includes(s.id),onToggleSelect:G},s.id))})]})})};export{y as default};
